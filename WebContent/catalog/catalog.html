<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>分类管理</title>
  <meta name="keywords" content="">
  <meta name="description" content="">
  <link href="../resources/plugins/hplus/css/bootstrap.min.css" rel="stylesheet">
  <link href="../resources/plugins/hplus/css/font-awesome.min.css" rel="stylesheet">
  <link href="../resources/plugins/hplus/css/animate.min.css" rel="stylesheet">
  <link href="../resources/plugins/hplus/css/style.min.css" rel="stylesheet">
  <link href="../resources/plugins/zTree/css/zTreeStyle/zTreeStyle.css" rel="stylesheet"/>
  <link href="../resources/plugins/zTree/css/demo.css" rel="stylesheet"/>
  <link href="../resources/plugins/hplus/css/plugins/jqpagination/fy.css" rel="stylesheet"/>
  <!--<link href="../resources/css/catalog.css" rel="stylesheet">-->
  <script src="../resources/plugins/hplus/js/jquery-2.1.1.min.js"></script>
  <script src="../resources/plugins/zTree/js/jquery.ztree.core-3.5.js"></script>
  <script src="../resources/plugins/zTree/js/jquery.ztree.excheck-3.5.js"></script>
  <script src="../resources/plugins/zTree/js/jquery.ztree.exedit-3.5.js"></script>
  <script src="../resources/plugins/hplus/js/bootstrap.min.js"></script>
  <script src="../resources/plugins/hplus/js/content.min.js"></script>
  <script src="../resources/js/context.utils.js"></script>
  <script src="../resources/js/common.utils.js"></script>
</head>
<style>
/*工具条区域样式*/
.toobarArea{
  height:40px;
  width:100%;
  line-height:30px;
  background:#eff3f6;
  border-top:1px solid #ccc;
  border-bottom:1px solid #ccc;
  padding-left:15px;
  padding-top:5px;
  overflow:hidden;
}
/*按钮*/
.toobarArea button{
  width:60px;
  height:24px;
  margin-top:-4px;
  background:#0077c7;
  color:white;
  text-align:center;
  padding:2px;
  font-size:12px;
  border-radius: 0px;
}
/*主区域*/
.mainArea{
  height: calc(100% - 40px);
  width: 100%;
  position: absolute;
  overflow: auto;
}
/*分类列表*/
.catListArea{
  position: absolute;
  left: 0;
  top: 0;
  width: 420px;
  height: 100%;
  border-right: 1px solid #ccc;
  overflow: hidden;
  padding-bottom: 30px;
}
/*内容详情*/
.catDetailArea{
  position:absolute;
  right:0;
  top:0;
  height:100%;
  width:calc(100% - 400px);
  background:white;
}

/*模态窗口样式设置*/
.my-mbody{
  background-color: #F8FAFB;
}
h4{
  font-weight:bold;
  padding-left:10px;
  text-align:left;
}

/* 配置：表单区域 */
.modal-body tr{
  width:100%;
}
.modal-body tr .th{
  margin-left:30px;
  height:60px;
  line-height:36px;
  font-size:14px;
  font-weight:bold;
  font-family:"open sans","Helvetica Neue",Helvetica,Arial,sans-serif;
  width:200px;
  text-width:190px;
  padding-right:10px;
  font-weight:nomal;
  text-align:right;
}
.modal-body tr .add-th{
  width:120px;
}
.modal-body tr td input{
  width:380px;
}
#nodePath{
  top: 23px;
  width: 380px;
  position: absolute;
}
/*遮罩层样式*/
#shade{
  width: 100%;
  height: 100%;
  position: fixed;
  top: 0;
  left: 0;
  background: rgba(0,0,0,0.65);
  z-index: 100;
  display: none;
}
/* 配置：表单区域 */
.opeBox{
  display: none;
  position: absolute;
  top: 10%;
  left: 20%;
  width: 560px;
  background: white;
  border-radius: 4px;
  font-size: 14px;
  z-index: 10000;
}
/*左侧样式*/
ul,li{
  list-style: none;
}
a:link,a:visited{
  text-direction:none;
}
</style>
<body style="overflow:hidden;">
  <div style="height:100%">
    <!--菜单栏-->
    <div class="toobarArea">
      <button type="button" id="add" opeType="claAdd" class="btn" style="margin-right:3px;">添加</button>
      <button type="button" id="mod" opeType="claMod" class="btn" style="margin-right:3px;">修改</button>
      <button type="button" id="del" opeType="claDel" class="btn" style="margin-right:3px;">删除</button>
    </div>
    <!--显示主区域-->
    <div class="mainArea">
      <!--左侧列表-->
      <div id="catListArea" class="catListArea">
        <!--动态加载分类列表-->
        <ul id="cataTree" class="ztree" style="width: 290px;height: 470px;margin-left:35px;margin-top:35px;"></ul>
      </div>
      <!--右侧详情-->
      <div id="catDetailArea" class="catDetailArea">
        <!--动态加载电台分类详情-->
        <div class="col-sm-12">
          <div class="ibox float-e-margins">
            <h5>分类详情</h5>
            <div class="ibox-content">
              <ul class="detail"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- 遮罩 -->
    <div id="shade"></div>
    <!--弹出内容:添加节点-->
    <div id="addCata" class="modal inmodal" data-backdrop="static">
      <div class="modal-dialog" style="width:660px; margin:10px auto 0 auto">
        <div class="modal-content">
          <div class="modal-header" style="padding-bottom:5px;">
            <button type="button" class="close" id="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            <h4 class="modal-title" style="margin-bottom:5px;">添加节点</h4>
          </div>
          <div class="modal-body my-mbody" style="padding-bottom:0px; 15px;">
            <form id="verOperForm" enctype ="multipart/form-data">
              <table>
                <tr>
                  <td class="th add-th">节点路径</td>
                  <td colspan="3"><div class="form-control" id="nodePath" name="nodePath" ></div></td>
                </tr>
                <tr>
                  <td class="th add-th">节点名称</td>
                  <td colspan="3"><input type="text" class="form-control" id="nodeNames" name="nodeNames" placeholder="节点名称" aria-required="true"></td>
                </tr>
                <tr>
                  <td class="th add-th">节点编码</td>
                  <td colspan="3"><input id="nodeCode" name="nodeCode" class="form-control" type="text" placeholder="节点编码" aria-required="true"></td>
                </tr>
                <tr>
                  <td class="th add-th">节点别名</td>
                  <td colspan="3"><input id="aliasName" name="aliasName" class="form-control" type="text" placeholder="节点别名" aria-required="true"></td>
                </tr>
                <tr>
                  <td class="th add-th">节点描述</td>
                  <td colspan="3"><input id="nodeDescn" name="nodeDescn" class="form-control" type="text" placeholder="节点描述" aria-required="true"></td>
                </tr>
              </table>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-white cancel" data-dismiss="modal">关闭</button>
            <button id="save" type="button" class="btn btn-primary">提交</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
<script>
var zTreeObj;
var rootPath=getRootPath();
//需要加载的分类树的数据，以list方式给出
var loadTreeData=[{CatalogType:"1",TreeViewType:"zTree"}, {CatalogType:"3",TreeViewType:"zTree"}, {CatalogType:"2",TreeViewType:"zTree"}];

//初始化方法：页面加载完成后执行
$(function() {
  //0-初始化页面
  //0.1-初始化树样式
  zTreeObj=$.fn.zTree.init($("#cataTree"), {
    view:{
      selectedMulti: false//是否允许同时选中多个节点
    },
    edit:{
      enable: true,//是否开启异步模式
      showRemoveBtn: false,//是否显示删除按钮
      showRenameBtn: false//是否显示编辑名称按钮
    },
    check:{
      enable: false//设置 zTree的节点上是否显示 checkbox / radio
    },
    data:{
      simpleData:{
        enable: true
      }
    }
  });

  //1-加载数据
  //1.1-加载树
  loadTree(loadTreeData);

  //2-初始化按钮
  //2.1-点击添加，出现弹出层
  $("#add").on("click",function(){
    $("#addCata").modal("show");
    $("#shade").css({"display":"block"});
  });
});

/**
 * 加载树
 */
function loadTree(loadData) {
  var _url=rootPath+"baseinfo/getCataTree4View.do";
  var i=0;
  loadRecursion(0);

  function loadRecursion(index) {
    if (index==loadTreeData.length) return;
    $.ajax({
      type: "POST",    
      url: _url,
      dataType: "json",
      data: loadData[index++],
      success: function(jsonData){
        if(jsonData.ReturnType=="1001") {
          zTreeObj.addNodes(null,jsonData.Data,false);
        }
        loadRecursion(index);
      },
      error:function(jqXHR){
        alert("发生错误" + jqXHR.status);
      }
    });
  }
}

function whatdo() {
  //点击遮罩层,确定,取消按钮，遮罩层和弹出层消失
  $("#save,.close,#shade,.cancel").on("click",function(){
    $("#addCata").modal("hide");
    $("#shade").css({"display":"none"});
  });
  //提交按钮事件
  $("#save").on("click",function(){
    
  });
}
</script>
</html>
